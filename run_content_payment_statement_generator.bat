@echo off
chcp 65001 > nul
setlocal

rem コンテンツ関連支払い明細書生成システム 実行バッチファイル

echo ============================================================
echo コンテンツ関連支払い明細書生成システム
echo ============================================================

rem 引数チェック
if "%~1"=="" (
    echo 使用方法: %~nx0 年 月 [オプション]
    echo 例: %~nx0 2024 12
    echo 例: %~nx0 2024 12 --no-email
    echo 例: %~nx0 2024 12 --test
    goto :eof
)

if "%~2"=="" (
    echo エラー: 年と月を指定してください
    echo 使用方法: %~nx0 年 月 [オプション]
    goto :eof
)

rem Python実行
echo 処理対象: %~1年%~2月
echo 処理開始時刻: %date% %time%
echo ============================================================

python run_content_payment_statement_generator.py %*

echo ============================================================
echo 処理終了時刻: %date% %time%
echo ============================================================

if %ERRORLEVEL% NEQ 0 (
    echo エラーが発生しました。ログファイルを確認してください。
    pause
) else (
    echo 処理が正常に完了しました。
)

endlocal