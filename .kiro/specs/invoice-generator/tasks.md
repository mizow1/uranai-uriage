# Implementation Plan

- [ ] 1. プロジェクト構造とデータモデルの設定
  - データモデルクラスとユーティリティ関数を作成
  - 必要なライブラリをインストールして依存関係を設定
  - _Requirements: 1.1, 1.2_

- [ ] 2. データ読み込みモジュールの実装
  - [ ] 2.1 売上集計CSVファイル読み込み機能の実装
    - CSVファイルを読み込み、データフレームに変換する機能を実装
    - 必要なデータ検証と前処理を追加
    - _Requirements: 1.1_

  - [ ] 2.2 明細書テンプレート検索機能の実装
    - 明細書テンプレートフォルダから最新のテンプレートを検索する機能を実装
    - 年フォルダ構造を解析し、最新の明細書を特定
    - _Requirements: 1.2_

  - [ ] 2.3 明細書テンプレート読み込み機能の実装
    - Excelファイルを読み込み、必要なデータを抽出する機能を実装
    - テンプレート構造を解析し、データマッピングを準備
    - _Requirements: 1.3_

- [ ] 3. データマッチングモジュールの実装
  - [ ] 3.1 ファジーマッチングアルゴリズムの実装
    - 文字列類似度計算関数の実装
    - 複数のアルゴリズムを組み合わせた最適なマッチング手法の実装
    - _Requirements: 2.1, 2.2_

  - [ ] 3.2 コンテンツ名マッチング機能の実装
    - 売上データのコンテンツ名と明細書テンプレートの商品名をマッチングする機能を実装
    - マッチング結果の信頼度を計算
    - _Requirements: 2.1_

  - [ ] 3.3 プラットフォーム名マッチング機能の実装
    - 売上データのプラットフォーム名と明細書テンプレートのプラットフォーム名をマッチングする機能を実装
    - マッチング結果の信頼度を計算
    - _Requirements: 2.2_

  - [ ] 3.4 マッチング結果の検証と警告機能の実装
    - マッチングの信頼度が低い場合に警告を表示する機能を実装
    - ユーザーに確認を求めるインターフェースの実装
    - _Requirements: 2.3_

- [ ] 4. 明細書生成モジュールの実装
  - [ ] 4.1 明細書テンプレートを元にした新規明細書作成機能の実装
    - テンプレートをコピーして新しい明細書を作成する機能を実装
    - マッチングされたデータを適切なセルに配置
    - _Requirements: 1.3_

  - [ ] 4.2 出力先パス決定機能の実装
    - 年フォルダ構造を作成し、適切なファイル名を生成する機能を実装
    - yyyymmdd.xls形式のファイル名生成ロジックの実装
    - _Requirements: 3.1, 3.2_

  - [ ] 4.3 ファイル存在確認と上書き確認機能の実装
    - 同名ファイルの存在を確認し、上書き前に確認を求める機能を実装
    - ユーザーの選択に基づいた処理分岐の実装
    - _Requirements: 3.3_

  - [ ] 4.4 明細書保存機能の実装
    - 生成された明細書を指定されたパスに保存する機能を実装
    - ファイル形式の適切な設定と保存処理
    - _Requirements: 3.1, 3.2_

- [ ] 5. ユーザーインターフェースの実装
  - [ ] 5.1 コマンドライン引数処理機能の実装
    - 入力パスと出力パスをコマンドライン引数から取得する機能を実装
    - デフォルト値の設定と引数検証
    - _Requirements: 1.1, 1.2_

  - [ ] 5.2 進行状況表示機能の実装
    - 処理の各ステップでの進行状況を表示する機能を実装
    - 処理時間の長い操作での進捗バーの実装
    - _Requirements: 4.1, 4.2_

  - [ ] 5.3 エラーメッセージ表示機能の実装
    - エラー発生時に具体的なメッセージと解決策を表示する機能を実装
    - エラーログの記録機能の追加
    - _Requirements: 4.4_

  - [ ] 5.4 処理結果表示機能の実装
    - 処理完了時に結果概要を表示する機能を実装
    - 生成されたファイルのパスと処理統計の表示
    - _Requirements: 4.3_

- [ ] 6. 統合とテスト
  - [ ] 6.1 モジュール統合の実装
    - 各モジュールを連携させるメインスクリプトの実装
    - エラーハンドリングとフロー制御の実装
    - _Requirements: 1.1, 1.2, 1.3, 1.4_

  - [ ] 6.2 ユニットテストの実装
    - 各モジュールの機能をテストするユニットテストの実装
    - エッジケースと異常系のテスト
    - _Requirements: 全て_

  - [ ] 6.3 統合テストの実装
    - エンドツーエンドのワークフローをテストする統合テストの実装
    - 実際のデータを使用したテスト
    - _Requirements: 全て_

  - [ ] 6.4 デバッグと最適化
    - パフォーマンスのボトルネックを特定し最適化
    - メモリ使用量の最適化
    - エラーケースの追加対応
    - _Requirements: 全て_
